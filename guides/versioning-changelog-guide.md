# バージョン管理と変更履歴ガイド

このドキュメントでは、DynamicExitStrategyImplementationプロジェクトのバージョン管理と変更履歴の追跡方法について説明します。

## 目次

1. [バージョン番号付けの方針](#バージョン番号付けの方針)
2. [変更履歴の管理](#変更履歴の管理)
3. [リリースプロセス](#リリースプロセス)
4. [ブランチ管理戦略](#ブランチ管理戦略)
5. [変更のバックポート](#変更のバックポート)

## バージョン番号付けの方針

このプロジェクトは[セマンティックバージョニング](https://semver.org/)に従っています。バージョン番号は `MAJOR.MINOR.PATCH` の形式で付与されます：

1. **MAJOR**: 後方互換性のない変更が含まれる場合に増加
2. **MINOR**: 後方互換性のある機能追加の場合に増加
3. **PATCH**: 後方互換性のあるバグ修正の場合に増加

例：
- `1.0.0` - 初期リリース
- `1.1.0` - 新機能の追加
- `1.1.1` - バグ修正
- `2.0.0` - 後方互換性のない変更

前提開発版については、`MAJOR.MINOR.PATCH-alpha.N` または `MAJOR.MINOR.PATCH-beta.N` の形式を使用します。

## 変更履歴の管理

すべての変更は [CHANGELOG.md](../../CHANGELOG.md) ファイルに記録されます。変更履歴の記録には以下のガイドラインに従ってください：

### CHANGELOG.mdのフォーマット

```markdown
# 変更履歴

すべての注目すべき変更はこのファイルに記録されます。

## [未リリース] - YYYY-MM-DD

### 追加
- 新しい機能Aを追加
- 新しいAPIメソッドXを追加

### 変更
- コンポーネントBの動作を改善
- パフォーマンスを最適化

### 修正
- バグCを修正
- 例外処理を改善

### 削除
- 非推奨のメソッドDを削除

## [1.1.0] - YYYY-MM-DD

### 追加
...
```

### 変更カテゴリ

変更は以下のカテゴリに分類します：

- **追加** (Added): 新機能
- **変更** (Changed): 既存機能の変更
- **非推奨** (Deprecated): 将来のリリースで削除される予定の機能
- **削除** (Removed): 今回のリリースで削除された機能
- **修正** (Fixed): バグ修正
- **セキュリティ** (Security): セキュリティ関連の修正

### チェンジログ更新手順

1. 新しい変更をする際は、`[未リリース]`セクションに変更内容を追加します
2. リリース時に`[未リリース]`を実際のバージョン番号と日付に置き換えます
3. 新しい`[未リリース]`セクションを追加して次のリリースの準備をします

## リリースプロセス

新しいバージョンをリリースする際は、以下の手順に従います：

1. **変更履歴の更新**:
   - `[未リリース]`セクションをバージョン番号と日付に更新
   - 次の開発サイクルのために新しい`[未リリース]`セクションを作成

2. **バージョン番号の更新**:
   - アセンブリ情報ファイルのバージョン番号を更新
   - プロジェクトファイルのバージョン番号を更新

3. **ビルドとテスト**:
   - すべてのテストが通ることを確認
   - リリースビルドを作成
   - 主要な機能を手動でテスト

4. **タグ付けとリリース**:
   - Gitでバージョンタグを作成: `git tag v1.1.0`
   - タグをリモートにプッシュ: `git push origin v1.1.0`
   - GitHub Releasesでリリースを作成

5. **ドキュメントの更新**:
   - ドキュメントがリリースバージョンを反映していることを確認
   - 必要に応じてREADMEやその他のドキュメントを更新

## ブランチ管理戦略

このプロジェクトではGitFlow（もしくは簡易化したバージョン）を採用しています：

### 主要ブランチ

- **master**: 最新の安定リリース
- **develop**: 開発の最前線、次のリリースの準備

### サポートブランチ

- **feature/XXX**: 新機能の開発用
- **bugfix/XXX**: バグ修正用
- **release/X.Y.Z**: リリース準備用
- **hotfix/XXX**: 緊急のバグ修正用

### ブランチワークフロー

1. **機能開発**:
   - developから分岐: `git checkout -b feature/new-feature develop`
   - 開発完了後、developにマージ: `git checkout develop && git merge --no-ff feature/new-feature`

2. **リリース準備**:
   - developから分岐: `git checkout -b release/1.1.0 develop`
   - バージョン番号更新、最終テスト、バグ修正
   - 完了後、masterとdevelopの両方にマージ
   
3. **ホットフィックス**:
   - masterから分岐: `git checkout -b hotfix/critical-bug master`
   - 修正後、masterとdevelopの両方にマージ

## 変更のバックポート

重要な修正を古いバージョンにバックポートする場合は、以下の手順に従います：

1. 最新の修正を含むコミットを特定
2. メンテナンスブランチを作成: `git checkout -b maint-X.Y.Z vX.Y.Z`
3. 必要な修正をチェリーピック: `git cherry-pick <commit-hash>`
4. バージョン番号を更新（例：1.0.0 → 1.0.1）
5. 変更履歴を更新
6. テストを実行して問題がないことを確認
7. メンテナンスブランチからリリース

## 例：バージョン更新のコミット

バージョン番号を更新する際のコミット例：

```
バージョンを1.1.0に更新

- CHANGELOG.mdを更新
- アセンブリバージョンを更新
- ドキュメントのバージョン参照を更新

リリースノート:
- 新しいモメンタム指標の実装
- パフォーマンスの最適化
- スレッド安全性の改善
```

## まとめ

バージョン管理と変更履歴の適切な維持は、プロジェクトの進行状況を追跡し、ユーザーに変更内容を明確に伝えるために重要です。常にセマンティックバージョニングのルールに従い、CHANGELOGを最新の状態に保つよう心がけてください。